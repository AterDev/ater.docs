# 配置
## 数据库配置
默认使用本地`postgresql`数据库。

生成项目`EntityFramework.Migrator`,
- 在`Projgram.cs`配置使用的数据库驱动类型；
- 在`appsetings.json`中的数据库连接字符串

在运行项目中`Http.API`与`IdentityServer`，
- 确保数据库连接和数据库驱动与生成项目一致。

## 主键类型配置
`IdentityServer`项目中，修改主键类型，默认为**Guid**，需要修改以下两处：
```csharp
services.AddDbContext<IdentityContext>(options =>
    options.UseNpgsql(identityConnection).UseOpenIddict<Guid>());
```

```csharp
services.AddOpenIddict()
    .AddCore(options =>
    {
        options.UseEntityFrameworkCore()
            .UseDbContext<IdentityContext>()
            .ReplaceDefaultEntities<Guid>();
        options.UseQuartz();
    })
```


# 运行
## 一键运行
直接运行脚本 `TODO`

## 数据库迁移
`IdentityServer`会在执行时，生成数据库结构，及插入默认数据，相关代码可在`Program.cs`中进行修改。
`Entityframework.Migrator`项目用来管理数据库迁移内容.

## 启动IdentityServer
`dotnet watch run`，默认端口`5001`.
## 启动Http.API
`dotnet watch run`，默认端口`15002`.
## 启动Admin
`ng serve --ssl`，默认端口`4200`.